---
title: "Fear of Flying - Risk Evaluation"
format: html
editor: visual
---

\

## Fear of Flying

(Insert language that expounds on the fear of flying).

## What Does the Data Say?

```{r}
library(tidyverse)
library(readxl)
library(janitor)

# Air traffic data (total commercial passenger flights per year) ----------

# data taken from here: https://www.kaggle.com/datasets/yyxian/u-s-airline-traffic-data/code
airtraffic <- read_csv("data/airtraffic.csv")

airtraffic2 <- airtraffic %>% 
  janitor::clean_names() %>%
  select(year, month, pax, flt) %>%
  rename(passengers_total = pax, flights_total = flt)

# Airplane crash data ------------------------------------------------------

## Get full file paths for data download
files <- list.files(path = paste0(getwd(), "/data/ntsb_data"), full.names = TRUE)


ntsb_data <- lapply(files, function(file) {
  
  df <- read_csv(file)
  df <- df %>% 
    janitor::clean_names()
  return(df)
  
}) 

## Apply the names of the file to the ntsb_data object to more easily identify different dataframes

file_names <- list.files(path = paste0(getwd(), "/data/ntsb_data"), full.names = FALSE)
file_names <- gsub(".txt", "", file_names)
names(ntsb_data) <- file_names

## Select columns from the "events" table -------------------------------------
events <- ntsb_data$events %>%
  select(ev_id, ntsb_no, ev_type, ev_date, ev_city, ev_state, ev_country,
         mid_air, on_ground_collision, latitude, longitude)


## Select columjns from the "aircraft" table ----------------------------------

aircraft <- ntsb_data$aircraft %>%
  select(ev_id, aircraft_key, ntsb_no, acft_make, 
         acft_model, acft_category, pax_seats, owner_acft)

## Select columns from the "injury" table -------------------------------------

injury <- ntsb_data$injury %>%
  select(ev_id, aircraft_key, inj_person_category, injury_level, inj_person_count)


# Left off: -----------

# look for commercial flight distinguisher besides pax_seats
# combine events, aircraft, and injury tables?


# Questions / Mental Outline  --------------------------------------------------

## What questions am I trying to answer?

### Number of commercial passenger planes that experienced any type of incident
### Number of commercial passenger planes that experienced any type of injury or death
### Numbre of commercail passenger planes that experienced fatalities

## There is one ev_id per incident, but one incident could invole more than one aircraft.

## First step --> isolate commercial planes

data_dictionary <- ntsb_data$eADMSPUB_DataDictionary

test <- data_dictionary %>% filter(table == "events")

# dt_events: logs changes made to event IDs






# unique_values <- lapply(colnames(crashdata2), function(elem){
#   
#  x <- unique(crashdata2[[elem]])
#  return(x)
#   
# })
# 
# names(unique_values) <- colnames(crashdata2)

# test <- crashdata2 %>% 
#   group_by(make, model) %>% 
#   filter(str_detect(tolower(make), "boeing|airbus")) %>% 
#   summarise(n = n())

```

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).

Thi
